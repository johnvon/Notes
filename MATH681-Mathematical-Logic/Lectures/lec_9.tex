\lecture{9}{2 Feb. 11:30}{Proving the \hyperref[thm:completeness]{Completeness Theorem}}
To finish the proof of \autoref{thm:completeness} \autoref{thm:completeness-2}, we follow the plan mentioned last lecture, and prove the following.

\begin{theorem}\label{thm:lec9}
	If \(T\) is a \hyperref[def:maximal]{maximal} \hyperref[def:consistent]{consistent} \hyperref[def:theory]{\(\mathcal{L} \)-theory} with \hyperref[def:Henkin-constant]{Henkin constants}, then \(T\) has a \hyperref[def:model]{model}.
\end{theorem}
\begin{proof}\let\qed\relax
	The \hyperref[def:model]{model} we build is called a ``canonical model.'' Let \(\mathcal{C} \) be the set of constants in \(\mathcal{L} \), and define an equivalence relation \(\sim \) on \(\mathcal{C} \) by \(c \sim d\) if and only if \(c=d\) is in \(T\).

	\begin{claim}
		The relation \(\sim \) on \(\mathcal{C} \) defined by \(c \sim d \iff c=d \in T\) is an equivalence relation.
	\end{claim}
	\begin{explanation}
		We check the axioms for being an equivalence relation.
		\begin{enumerate}[(a)]
			\item \(c \sim c\) because \(c = c\) is in \(T\) by \autoref{A7} \autoref{def:axioms-for-equality-a}.\footnote{Otherwise, \(c \neq c\) is in \(T\) from the \hyperref[def:maximal]{maximality}, so \(T \vdash c \neq c\) with \(T\vdash c = c\), so \(T\) would be \hyperref[def:inconsistent]{inconsistent}.}
			\item If \(c \sim d\), then \(c = d\) is in \(T\) so \(d = c\) is in \(T\) by \autoref{A7} \autoref{def:axioms-for-equality-b}, i.e., \(d \sim c\).
			\item If \(c \sim d\) and \(d \sim e\), then \(c = d \text{ and } d = e \in T \implies c = e \in T\) by \autoref{A7} \autoref{def:axioms-for-equality-c}, so \(c \sim e\).
		\end{enumerate}
	\end{explanation}

	Let \([c]\) be the equivalence class of \(c\). Define an \hyperref[def:structure]{\(\mathcal{L} \)-structure} \(\mathcal{M} \) with domain \(M=\quotient{\mathcal{C}}{\sim} = \left\{ [c] \mid c\in \mathcal{C} \right\} \), with functions, relations, and constants defined as follows:
	\begin{enumerate}[(a)]
		\item \(c^{\mathcal{M} } = [c]\).
		\item \(R^{\mathcal{M} }([c_1], \dots , [c_n]) \) \hyperref[def:truth]{true} if \(R(c_1, \dots , c_n)\) is in \(T\). This is well-defined by \autoref{A7} \autoref{def:axioms-for-equality-e}.
		\item \(f^{\mathcal{M} }([c_1], \dots , [c_n]) = [d]\) if \(f(c_1, \dots , c_n) = d\) is in \(T\). Such a \(d\) exists because \(\exists x\ f(c_1, \dots , c_n) = x\), i.e., \(\lnot \forall x\ f(c_1, \dots , c_n) \neq x\), is in \(T\).\footnote{Otherwise, \(\forall x\ f(c_1, \dots , c_n) \neq x\) is in \(T\). By \autoref{A4}, \(f(c_1, \dots , c_n) \neq f(c_1, \dots , c_n)\) is in \(T\), contradicts to \autoref{A7} \autoref{def:axioms-for-equality-a}.} If this is in \(T\), then there is a \hyperref[def:Henkin-constant]{Henkin constant} \(d\) with \(f(c_1, \dots , c_n) = d\) in \(T\). To show that this is well-defined, from \autoref{A7} \autoref{def:axioms-for-equality-d}, i.e.,
		      \[
			      (t_1 = u_1 \land \dots \land t_n = u_n) \to f(t_1, \dots , t_n) = f(u_1, \dots , u_n).
		      \]
		      So if \([c_1] = [d_1], \dots , [c_n] = [d_n]\), then \(c_1 = d_1, \dots , c_n = d_n\) are in \(T\). So \(f(c_1, \dots , c_n) = f(d_1, \dots , d_n)\) is in \(T\) by \autoref{A7} \autoref{def:axioms-for-equality-d}. If \(a\) and \(b\) are constants such that \(f(c_1, \dots , c_n) = a\) and \(f(d_1, \dots , d_n) = b\) are in \(T\), so \(a = b\) is in \(T\) by \autoref{A7} \autoref{def:axioms-for-equality-c}, i.e., the transitivity of \(=\).
	\end{enumerate}

	Now we need to show that \(\mathcal{M} \models T\), i.e., we claim that
	\[
		\mathcal{M} \models \varphi ([c_1], \dots , [c_n]) \iff \varphi (c_1, \dots , c_n) \text{ is in } T.
	\]
	We prove this by induction on \hyperref[def:term]{terms} and then \hyperref[def:formula]{formulas}.
	\begin{enumerate}
		\item \hyperref[def:term]{Terms}: Show that \(t^{\mathcal{M} }([c_1], \dots , [c_n]) = [d]\) if and only if \(t(c_1, \dots , c_n) = d\) is in \(T\).
		      \begin{enumerate}
			      \item If \(t\) is a constant \(e\), \(t^{\mathcal{M} }([c_1], \dots , c_n) = e^{\mathcal{M} } = [e] \), and
			            \[
				            [e] = t^{\mathcal{M} }([c_1], \dots , [c_n]) = [d]
				            \iff [e]=[d]
				            \iff \text{\(e=d\) is in \(T\)}.
			            \]
			      \item If \(t\) is \(x_i\), \(t^{\mathcal{M} }([c_1], \dots [c_n]) = [c_i]\). This is equal to \([d]\) if and only if \(c_i = d\) is in \(T\).
			      \item Suppose that \(t(x_1, \dots , x_n) = f(s_i(x_1, \dots , x_n), \dots , s_m(x_1, \dots , x_n))\). Let
			            \[
				            [d_i] = s_i^{\mathcal{M} }([c_1], \dots , [c_n]) ,
			            \]
			            by the inductive hypothesis, \(d_i = s_i(c_1, \dots , c_n)\) is in \(T\). Let \([e] = f^{\mathcal{M} }([d_1], \dots , [d_m]) = t^{\mathcal{M} } ([c_1], \dots , [c_n])\). By the definition of \(f\), \(e = f(d_1, \dots , d_m)\) is in \(T\). By \autoref{A7} \autoref{def:axioms-for-equality-d},
			            \[
				            e = f(s_1(c_1, \dots , c_n), \dots , s_m(c_1, \dots , c_n))
			            \]
			            is in \(T\). This is the direction (\(\implies \)).

			            Now suppose that \(t(c_1, \dots , c_n) = e^\prime \) is in \(T\). We want to show that \([e]=[e^\prime ]\), i.e., \(e = e^\prime \) is in \(T\). Since \(e = t(c_1, \dots , c_n)\) is in \(T\), and \(e^\prime = t(c_1, \dots , c_n)\) is in \(T\). By \autoref{A7} \autoref{def:axioms-for-equality-c}, \(e = e^\prime \) is in \(T\), so \([e^\prime ] = [e]\ = t^{\mathcal{M} }([c_1], \dots , [c_n]) \). This is (\(\impliedby\)).
		      \end{enumerate}
		\item \hyperref[def:formula]{Formulas}: Show that \(\mathcal{M} \models \varphi ([c_1], \dots , [c_n])\) if and only if \(\varphi (c_1, \dots , c_n)\) is in \(T\).\footnote{In particular, for a \hyperref[def:sentence]{sentence} \(\varphi \), \(\mathcal{M} \models \varphi \iff \varphi \) is in \(T\), and so \(\mathcal{M} \models T\).}
		      \begin{enumerate}
			      \item If \(\varphi \) is \(s(x_1, \dots , x_n)=t(x_1, \dots , x_n)\):
			            \begin{enumerate}
				            \item[(\(\implies\))] If \(\mathcal{M} \models s([c_1], \dots , [c_n]) = t([c_1], \dots , [c_n])\),
					            \[
						            s^{\mathcal{M} } ([c_1], \dots , [c_n]) = t^{\mathcal{M} } ([c_1], \dots , [c_n]).
					            \]
					            Let \([d]\) be this element equal to the above, so \(d=s(c_1, \dots , c_n)\) and \(d=t(c_1, \dots , c_n)\) are in \(T\) so \(\underbrace{s(c_1, \dots , c_n) = t(c_1, \dots , c_n)}_{\varphi (c_1, \dots , c_n)}\) is in \(T\) by \autoref{A7} \autoref{def:axioms-for-equality-c}.
				            \item[(\(\impliedby\))] If \(s(c_1, \dots , c_n) = t(c_1, \dots , c_n)\) is in \(T\), let
					            \[
						            [d]=s^{\mathcal{M} }([c_1], \dots , [c_n]) \text{ and } [e]=t^{\mathcal{M} }([c_1], \dots , [c_n]),
					            \]
					            so \(d=s(c_1, \dots , c_n)\) and \(e=t(c_1, \dots , c_n)\) are in \(t\), so \(d=e\) is in \(t\), and \([e]=[d]\).
			            \end{enumerate}
			      \item If \(\varphi \) is \(R(t_1(\overline{x} ), \dots , t_m(\overline{x} ))\): Let \([d_i]=t_i^{\mathcal{M} }([c_1], \dots , [c_n]) \),
			            % https://q.uiver.app/?q=WzAsNSxbMCwwLCJSXntcXG1hdGhjYWx7TX19KFtkXzFdLCBcXGxkb3RzLCBbZF9tXSlcXHRleHR7IGlzIHRydWV9Il0sWzIsMCwiUihkXzEsIFxcbGRvdHMsIGRfbSlcXHRleHR7IGlzIGluIH0gVCJdLFsyLDEsIlIodF8xKFxcb3ZlcmxpbmV7Y30pLCBcXGxkb3RzLCB0X20oXFxvdmVybGluZXtjfSkpXFx0ZXh0eyBpcyBpbiB9IFQiXSxbMCwxLCJSXntcXG1hdGhjYWx7TX19KHRee1xcbWF0aGNhbHtNfX1fMVtcXG92ZXJsaW5le2N9XSwgXFxsZG90cywgdF57XFxtYXRoY2Fse019fV9tW1xcb3ZlcmxpbmV7Y31dKVxcdGV4dHsgaXMgdHJ1ZX0iXSxbMCwyLCJcXG1hdGhjYWx7TX1cXG1vZGVscyBcXHZhcnBoaShbY18xXSwgXFxsZG90cywgW2Nfbl0pIl0sWzAsMSwiIiwwLHsic3R5bGUiOnsidGFpbCI6eyJuYW1lIjoiYXJyb3doZWFkIn19fV0sWzEsMiwiIiwwLHsic3R5bGUiOnsidGFpbCI6eyJuYW1lIjoiYXJyb3doZWFkIn19fV0sWzAsMywiIiwyLHsic3R5bGUiOnsidGFpbCI6eyJuYW1lIjoiYXJyb3doZWFkIn19fV0sWzMsNCwiIiwyLHsic3R5bGUiOnsidGFpbCI6eyJuYW1lIjoiYXJyb3doZWFkIn19fV1d
			            \[\begin{tikzcd}
					            {R^{\mathcal{M}}([d_1], \dots, [d_m])\text{ is true}} && {R(d_1, \dots, d_m)\text{ is in } T} \\
					            {R^{\mathcal{M}}(t^{\mathcal{M}}_1[\overline{c}], \dots, t^{\mathcal{M}}_m[\overline{c}])\text{ is true}} && {R(t_1(\overline{c}), \dots, t_m(\overline{c}))\text{ is in } T} \\
					            {\mathcal{M}\models \varphi([c_1], \dots, [c_n])}
					            \arrow[tail reversed, Leftrightarrow, from=1-1, to=1-3]
					            \arrow[tail reversed, Leftrightarrow, from=1-3, to=2-3]
					            \arrow[tail reversed, Leftrightarrow, from=1-1, to=2-1]
					            \arrow[tail reversed, Leftrightarrow, from=2-1, to=3-1]
				            \end{tikzcd}\]
			      \item If \(\varphi \) is \(\lnot \psi \): Then
			            \[
				            \mathcal{M} \models \varphi (\overline{c} )
				            \iff \mathcal{M} \not \models \psi ([\overline{c} ])
				            \iff \psi (\overline{c} )\text{ is not in } T
				            \iff \varphi (\overline{c} )\text{ is in } T
			            \]
			            where the last \(\iff \) follows from the fact that \(T\) is \hyperref[def:maximal]{maximal} and \hyperref[def:consistent]{consistent}.
			      \item If \(\varphi \) is \(\psi \to \theta \):
			            \begin{itemize}
				            \item If \(\psi (\overline{c} ) \to \theta (\overline{c} )\) is in \(T\): then if \(\psi (\overline{c} )\) is in \(T\), then \(\theta (\overline{c} )\) is in \(T\) by \hyperref[def:rule-of-inference]{(MP)}.then by the induction hypotheses, if \(\mathcal{M} \models \psi ([\overline{c} ])\), then \(\mathcal{M} \models \theta ([\overline{c} ])\).
				            \item If \(\mathcal{M} \models \psi ([\overline{c} ]) \to \theta ([\overline{c} ])\): then either \(\mathcal{M} \models \theta ([\overline{c} ])\) or \(\mathcal{M} \models \lnot \psi ([\overline{c} ])\). So either
				                  \begin{enumerate}
					                  \item \(\theta (\overline{c} )\) is in \(T\): by \autoref{A1}, \(\theta (\overline{c} ) \to (\psi (\overline{c} ) \to \theta (\overline{c} ))\), so \(\psi (\overline{c} )\to \theta (\overline{c} )\) is in \(T\).
					                  \item \(\lnot \psi (\overline{c} )\) is in \(T\): \(T\cup \left\{ \psi (\overline{c} ) \right\} \) is now \hyperref[def:inconsistent]{inconsistent}, so \(T \cup \left\{ \psi (\overline{c} ) \right\} \vdash \theta (\overline{c} )\). From the \hyperref[thm:deduction]{deductive theorem}, \(T\vdash \psi (\overline{c} )\to \theta (\overline{c} )\). Because \(T\) is \hyperref[def:maximal]{maximal} and \hyperref[def:consistent]{consistent}, \(\psi (\overline{c} ) \to \theta (\overline{c} )\) is in \(T\).
				                  \end{enumerate}
			            \end{itemize}
			            \setcounter{stoppedhere}{\value{enumii}}
		      \end{enumerate}
	\end{enumerate}
\end{proof}