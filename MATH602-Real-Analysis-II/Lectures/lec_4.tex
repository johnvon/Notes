\lecture{4}{08 Sep.\ 14:30}{Orthogonality and Projection}
\section{Hilbert Spaces}
Just like the case of \hyperref[def:normed-vector-space]{normed spaces}, the \hyperref[def:inner-product-space]{inner product spaces} are incomplete in general, hence we define the completed spaces of which, called \hyperref[def:Hilbert-space]{Hilbert spaces}.
\begin{definition}[Hilbert space]\label{def:Hilbert-space}
	A complete \hyperref[def:inner-product-space]{inner product space} is called a \emph{Hilbert space}.
\end{definition}

\begin{eg}
	Both \(\ell _2\) and \(L^2(\Omega , \Sigma , \mu )\) are \hyperref[def:normed-vector-space]{normed spaces} and complete, hence are \hyperref[def:Hilbert-space]{Hilbert space}.
\end{eg}

\subsection{Orthogonality}
We'll soon see that the key notion in \hyperref[def:Hilbert-space]{Hilbert space} theory is \hyperref[def:orthogonal]{orthogonality}.
\begin{definition}[Orthogonal complement]\label{def:orthogonal-complement}
	Let \(A \subseteq \mathcal{H} \) where \(\mathcal{H}\) is a \hyperref[def:Hilbert-space]{Hilbert space}, then the \emph{orthogonal complement} \(A^\perp\) of \(A\) is
	\[
		A^\perp \coloneqq \left\{ x\in \mathcal{H} \colon \left\langle x, y \right\rangle = 0 \text{ for } y\in A \right\}.
	\]
\end{definition}

\begin{remark}
	\(A^\perp\) is also a \hyperref[def:Hilbert-space]{Hilbert space}, in particular, closed and \(A^\perp \cap A \subseteq \left\{ 0 \right\} \).
\end{remark}
\begin{explanation}
	\(A^\perp\) is closed \hyperref[def:linear-vector-space]{linear subspace} of \(\mathcal{H} \) where the closure follows from the continuity of the function \(x\mapsto \left\langle x, y \right\rangle \) for \(x\in \mathcal{H} \) by looking at the inverse \hyperref[def:image]{image} of \(\left\{ 0 \right\}\). Also, for \(x\in A^\perp \cap A\), \(\left\langle x, x \right\rangle = 0\) implies \(x = 0\). The reverse inclusion is false since \(A\) can be empty.
\end{explanation}

The fundamental theory of \hyperref[def:Hilbert-space]{Hilbert spaces} is \autoref{thm:orthogonality-principle}.

\begin{theorem}[Orthogonality principle]\label{thm:orthogonality-principle}
	Assume \(E\subseteq \mathcal{H} \) is a closed \hyperref[def:linear-vector-space]{linear subspace} of the \hyperref[def:Hilbert-space]{Hilbert space} \(\mathcal{H} \) and \(x\in \mathcal{H} \). Then we have the following.
	\begin{enumerate}[(a)]
		\item There exists a unique closest point \(y = P_E x\in E\) to \(x\), i.e., \(\left\lVert x - P_E x\right\rVert = \inf _{y^\prime \in E} \left\lVert x - y^\prime \right\rVert \).
		\item The point \(y = P_E x\in E\) is the unique vector such that \(x - y\in E^{\perp}\).
	\end{enumerate}
	\begin{center}
		\incfig{orthogonality-principle}
	\end{center}
\end{theorem}
\begin{proof}
	Note that the function \(y^\prime \mapsto \left\lVert x - y^\prime \right\rVert \) for \(y^\prime \in E\) is \hyperref[def:convex-function]{convex}. We expect a minimizer \(y^\prime \).
	\begin{enumerate}[(a)]
		\item Let \(y_n\in E\) for \(n = 1, 2, \dots  \) be a minimizing sequence, i.e.,
		      \[
			      \lim\limits_{n \to \infty} \left\lVert x - y_n\right\rVert = \inf _{y^\prime \in E}\left\lVert x - y^\prime \right\rVert \eqqcolon d.
		      \]
		      From \hyperref[lma:parallelogram-law]{parallelogram law}, we have
		      \[
			      \left\lVert y_{n} - y_{m} \right\rVert^{2} + 4 \left\lVert x - (y_{n} + y_{m} ) / 2\right\rVert ^{2} = 2\left\lVert x - y_{n} \right\rVert ^{2} + 2\left\lVert x- y_{m} \right\rVert ^{2}.
		      \]
		      As \(n, m\to \infty \), the right-hand side goes to \(4d^{2} \). But since \(\frac{1}{2}(y_{n} + y_{m} )\in E\), we have \(\left\lVert x - \frac{1}{2}(y_{n} - y_{m} )\right\rVert \geq d\), so
		      \[
			      \lim\limits_{m \to \infty} \sup _{m \geq n}\left\lVert y_{n} - y_{m} \right\rVert^{2} = 0,
		      \]
		      which implies \(\left\{ y_{n}  \right\} \) is a Cauchy sequence. As \(\mathcal{H} \) is complete, we see that \(y_{n} \to y_{\infty }\in E\), with \(\left\lVert x - y_{\infty }\right\rVert=d \).

		      Now, with the fact that \(E\) is closed, we set \(y_\infty = P_E x\) where \(y_\infty \) is unique since if \(\left\lVert x - y_\infty \right\rVert = \left\lVert x - y^\prime _\infty \right\rVert = d \), again by the \hyperref[lma:parallelogram-law]{parallelogram law} where we now plug in \(y_\infty \) and \(y_\infty ^\prime \) instead of \(y_{n} \) and \(y_{m} \) as above, we see that \(\left\lVert y_\infty - y^\prime _\infty \right\rVert = 0\), hence \(y_\infty = P_E x \in E\) is well-defined.

		\item We now show \(P_E x\) is the unique vector \(y\in E\) such that \(x - y\perp E\), i.e., \(x-y\in E^\perp\). Let \(y^\prime \in E\) and let \(Q(t)\) be the quadratic
		      \[
			      Q(t)\coloneqq \left\langle x-P_E x + ty^\prime , x - P_E x + ty^\prime  \right\rangle = \left\lVert x - P_E x + ty^\prime \right\rVert ^{2}.
		      \]
		      Since \(t\mapsto Q(t)\) has a \textbf{strict} minimum at \(t = 0\), which implies \(Q^\prime (0) = 0\), i.e., \(\Re \left( x-P_E x, y^\prime  \right) = 0\) for all \(y^\prime \in E\), which further implies \(\left\langle x-P_E x, y^\prime  \right\rangle= 0\) for all \(y^\prime \in E\). This shows that \(x - P_E x\in E^{\perp}\).

		      Finally, we need to show \(P_E x\in E\) is the unique vector such \(x - P_E x\in E^\perp\). This can be seen from \(Q(t)=\left\lVert x - P_E x\right\rVert^{2} + t^{2} \left\lVert y^\prime \right\rVert^{2}\) for any \(y^\prime \in E\).
	\end{enumerate}
\end{proof}

We see that \hyperref[thm:orthogonality-principle]{orthogonality principle} is actually quite surprising, since to show existence of such a closest point, we typically need
\begin{enumerate}[(a)]
	\item \hyperref[def:compact]{Compactness},
	\item Non-degeneracy for uniqueness.
\end{enumerate}
But here by using \hyperref[lma:parallelogram-law]{parallelogram law} and the completeness of \(\mathcal{H} \), we don't need these.

\begin{remark}
	\hyperref[thm:orthogonality-principle]{Orthogonality principle} shows that the minimizer for the function \(y^\prime \mapsto \left\lVert x - y^\prime \right\rVert \) for \(y^\prime \in E\) is characterized by the orthogonality condition, i.e., \(x - y\perp E\) for some \(y\in E\).
\end{remark}

This suggests the following definition.

\begin{definition}[Orthogonal projection]\label{def:orthogonal-projection}
	Let \(\mathcal{H} \) be a \hyperref[def:Hilbert-space]{Hilbert space} ad let \(E\subseteq \mathcal{H} \) be a closed subspace. The \emph{orthogonal projection operator} \(P_E\colon \mathcal{H} \to E\) is given by \(x \mapsto P_E x\) where \(P_E x\) is defined uniquely via \(x - P_E x\in E^\perp\).
\end{definition}

The \hyperref[def:orthogonal-projection]{orthogonal projection} is actually a so-called \hyperref[def:bounded-linear-map]{bounded linear map} which is defined below.

\begin{definition}[Bounded linear map]\label{def:bounded-linear-map}
	Given a mapping \(A\colon E \to E\) on a \hyperref[def:Banach-space]{Banach space} \(E\), we say it's a \emph{bounded linear map} if it's \hyperref[def:bounded-map]{bounded} and \hyperref[def:linear-map]{linear}.

	\begin{definition}[Linear map]\label{def:linear-map}
		The operator \(A\) is \emph{linear} if for \(x, y\in E\), \(a, b\in \mathbb{C} \),
		\[
			A(ax + by) = a A(x) + b B(y).
		\]
	\end{definition}

	\begin{definition}[Bounded map]\label{def:bounded-map}
		The operator \(A\) is \emph{bounded} if
		\[
			\left\lVert A\right\rVert \coloneqq \sup _{\left\lVert x\right\rVert = 1} \left\lVert Ax\right\rVert < \infty.
		\]
	\end{definition}
\end{definition}

\begin{remark}
	Note that \(\left\lVert Ax\right\rVert \leq \left\lVert A\right\rVert \left\lVert x\right\rVert \) for \(x\in E\).
\end{remark}

We see that \(P_E x\) is a \hyperref[def:bounded-linear-map]{bounded linear map} \(P_E\colon \mathcal{H} \to E\subseteq \mathcal{H}\) with the properties \(P^{2} _E = P_E\) and \(\left\lVert x\right\rVert ^{2} = \left\lVert P_E x\right\rVert ^{2} + \left\lVert (I - P_E)x\right\rVert ^{2} \) since \((I - P_E)x\perp P_E x\). The latter property shows that
\[
	\left\lVert P_E\right\rVert \leq 1,\quad \left\lVert I - P_E \right\rVert \leq 1,
\]
and in fact, \(\left\lVert P_E\right\rVert = \left\lVert I-P_E\right\rVert = 1\). Also, \(I - P_E\) is also an \hyperref[def:orthogonal-projection]{orthogonal projection} onto \(E^\perp\).

\section{Fourier Series}
\hyperref[def:Hilbert-space]{Hilbert space} gives a geometric framework for studying \hyperref[def:Fourier-series]{Fourier series}. The classical Fourier analysis studies situations where a function \(f\colon [-\pi , \pi ]\to \mathbb{C} \) can be expanded as \hyperref[def:Fourier-series]{Fourier series}
\[
	f(t) = \sum_{k=-\infty }^{\infty} \hat{f} (k) \frac{1}{\sqrt{2\pi } }e^{ikt}
\]
with the Fourier coefficients
\[
	\hat{f} (k) = \frac{1}{\sqrt{2\pi } }\int _{-\pi}^\pi f(t) e^{-ikt}\,\mathrm{d} t.
\]

In order to make Fourier analysis rigorous, we have to understand what functions \(f\) can be written as \hyperref[def:Fourier-series]{Fourier series}, and in what sense the \hyperref[def:Fourier-series]{Fourier series} converges. To do so, it's of great advantage to depart from this specific situation and carry out Fourier analysis in an abstract \hyperref[def:Hilbert-space]{Hilbert space}. Let \(f(t)\) be a vector in the function space \(L^2([-\pi , \pi ])\), and the exponential functions \(e^{-ikt}\) will form a set of \hyperref[def:orthogonal]{orthogonal} vectors in this space. Then, \hyperref[def:Fourier-series]{Fourier series} will become an orthogonal decomposition of a vector \(f\) w.r.t.\ an \hyperref[def:orthogonal-system]{orthogonal system} of coordinates.

\subsection{Orthogonal Systems}
We first give the definition.

\begin{definition}[Orthogonal system]\label{def:orthogonal-system}
	A sequence \(\left\{ x_{k} \right\}_{k\geq 1} \) of non-zero vectors in a \hyperref[def:Hilbert-space]{Hilbert space} \(\mathcal{H} \) is \emph{orthogonal} if \(\left\langle x_{k} , x_{\ell} \right\rangle = 0\) for all \(\ell \neq k\).
\end{definition}

\begin{definition}[Orthonormal system]\label{def:orthonormal-system}
	An \hyperref[def:orthogonal-system]{orthogonal system} \(\left\{ x_{k} \right\}_{k\geq 1} \) is an \emph{orthonormal system} if in addition, we have \(\left\lVert x_{k} \right\rVert= 1 \) for all \(k\).
\end{definition}

Write it in a more compact way, \(\left\{ x_{k} \right\}_{k\geq 1} \) is \hyperref[def:orthonormal-system]{orthonormal} if \(\left\langle x_{k} , x_{\ell } \right\rangle = \delta _{k, \ell } \) where \(\delta \) is the \href{https://en.wikipedia.org/wiki/Kronecker_delta}{Kronecker delta}. Here is an immediate generation the given \hyperref[rmk:Pythagorean-theorem]{remark}.

\begin{theorem}[Pythagorean theorem]\label{thm:Pythagorean-theorem}
	Let \(\left\{ x_k \right\} _{k\geq 1}\) be an \hyperref[def:orthogonal-system]{orthogonal system} in a \hyperref[def:Hilbert-space]{Hilbert space} \(\mathcal{H} \). Then for every \(n \in \mathbb{N}\),
	\[
		\left\lVert \sum_{k=1} ^n x_k\right\rVert ^{2} = \sum_{k=1} ^n \left\lVert x_k\right\rVert ^{2}
	\]
\end{theorem}
\begin{proof}
	From \hyperref[def:orthogonal]{orthogonality}, we have
	\[
		\left\lVert \sum_{k=1}^{n} x_k \right\rVert ^2
		= \left\langle \sum_{k=1} ^n x_k, \sum_{k=1} ^n x_k \right\rangle
		= \sum_{k, j= 1}^n \left\langle x_k, x_j \right\rangle
		= \sum_{k=1} ^n \left\langle x_k, x_k \right\rangle
		= \sum_{k=1}^{n} \lVert x_k \rVert ^2.
	\]
\end{proof}

We now see some examples.

\begin{eg}[Canonical basis of \(\ell _2\)]
	In the space \(\ell _2\), \(x_{k} = (0, 0, \dots , 1 , 0, \dots , 0 )\in \ell _2\) for \(k = 1, 2, \dots\) is an \hyperref[def:orthonormal-system]{orthonormal system} in \(\ell _2\) forming a basis.
\end{eg}
\begin{eg}[Fourier basis in \(L^2\)]
	In the space \(L^2([-\pi , \pi ])\), consider the exponential
	\[
		e_k (t) = \frac{1}{\sqrt{2\pi } }e^{ikt}
	\]
	for \(t\in [-\pi , \pi ]\). The set \(\left\{ e_k \right\} _{k=-\infty }^{\infty} \) is an \hyperref[def:orthonormal-system]{orthonormal system} in \(L^2[-\pi , \pi ]\), forming a basis.
\end{eg}

\subsection{Fourier Series}
We can further generalize \hyperref[def:Fourier-series]{Fourier series} to any \hyperref[def:Hilbert-space]{Hilbert space} by letting \(\left\{ x_{k} \right\}_{k\geq 1} \) be an \hyperref[def:orthonormal-system]{orthonormal} set in \(\mathcal{H} \) as follows.

\begin{definition*}
	Consider an \hyperref[def:orthonormal-system]{orthonormal system} \(\left\{ x_k \right\} _{k=1}^{\infty} \) in a \hyperref[def:Hilbert-space]{Hilbert space} \(\mathcal{H} \) and a vector \(x\in \mathcal{H} \).
	\begin{definition}[Fourier series]\label{def:Fourier-series}
		The \emph{Fourier series} of \(x\) w.r.t.\ \(\left\{ x_k \right\}_{k\geq 1} \) is the formal series
		\[
			\sum_{k=1} ^{\infty} \left\langle x, x_k \right\rangle x_k.
		\]
	\end{definition}
	\begin{definition}[Fourier coefficient]\label{def:Fourier-coefficient}
		The coefficient \(\left\langle x, x_k \right\rangle \) in the \hyperref[def:Fourier-series]{Fourier series} are called \emph{Fourier coefficients} of \(x\).
	\end{definition}
\end{definition*}

To understand the convergence of \hyperref[def:Fourier-series]{Fourier series}, we first focus on the finite case and study the partial sums of \hyperref[def:Fourier-series]{Fourier series}. For \(n = 1, 2, \dots  \), we define \(S_{n} \colon \mathcal{H} \to E_{n} \) such that
\[
	S_n (x)= \sum_{k=1}^{n} \left\langle x, x_{k}  \right\rangle x_{k}
\]
for \(x\in \mathcal{H} \) where \(E_{n} = \Span(\left\{ x_1, \dots , x_{n}\right\})\). We see that \(S_n\) is a \hyperref[def:linear-map]{linear operator} and \(S_n= P_{E_n}\) is the \hyperref[def:orthogonal-projection]{orthogonal projection} onto \(E_n\) since \(\left\langle x -S_n(x), x_k \right\rangle = 0\) for \(k = 1, \dots  , n\), hence \(S_{n} (x)\in E_{n}\) and \(x-S_n(x)\perp E_n\).

\begin{theorem}[Bessel's inequality]\label{thm:Bessel-ineq}
	Let \(\left\{ x_k \right\} _k\) be an \hyperref[def:orthogonal-system]{orthogonal system} in a \hyperref[def:Hilbert-space]{Hilbert space} \(\mathcal{H} \). Then for every \(x\in \mathcal{H} \),
	\[
		\sum_{k=1}^{\infty}  \left\vert \left\langle x, x_{k}  \right\rangle  \right\vert ^{2} \leq \left\lVert x\right\rVert ^{2} .
	\]
\end{theorem}
\begin{proof}
	To estimate the size of \(S_n(x)\), consider \(x - S_n(x)\) and from \hyperref[thm:Pythagorean-theorem]{Pythagorean theorem},
	\[
		\left\lVert S_n(x)\right\rVert ^{2} + \left\lVert x - S_n (x)\right\rVert ^{2} = \left\lVert x\right\rVert ^{2} \implies \left\lVert S_{n} (x)\right\rVert ^{2} \leq \left\lVert x\right\rVert ^{2}.
	\]
	On the other hand, again by \hyperref[thm:Pythagorean-theorem]{Pythagorean theorem} and \hyperref[def:orthogonal]{orthogonality},
	\[
		\left\lVert S_{n} (x)\right\rVert ^{2} = \sum_{k=1} ^n \left\lVert \left\langle x, x_k \right\rangle x_k \right\rVert ^{2} = \sum_{k=1} ^n \left\vert \left\langle x, x_k \right\rangle  \right\vert ^{2} .
	\]
	We see that by combining these two inequalities and let \(n\to \infty \), we have the result.
\end{proof}
\begin{remark}
	In particular, we see that \(\left\lVert S_n (x)\right\rVert ^{2} = \sum_{k=1}^{n} \left\vert \left\langle x, x_{k}  \right\rangle \right\vert ^{2}\), with \(S_n = P_{E_n}\) we have \(\left\lVert P_{E_n} x \right\rVert^{2} \leq \left\lVert x\right\rVert ^{2}\) for all \(x\in \mathcal{H} \).
\end{remark}

This implies the following.

\begin{corollary}\label{col:lec4}
	Let \(\left\{ x_k \right\} _{k \geq 1}\) be an \hyperref[def:orthonormal-system]{orthonormal system} in a \hyperref[def:Hilbert-space]{Hilbert space} \(\mathcal{H} \). Then the \hyperref[def:Fourier-series]{Fourier series} \(\sum_{k} \left\langle x, x_{k}  \right\rangle x_{k}  \) for every \(x\in \mathcal{H} \) converges in \(\mathcal{H} \).
\end{corollary}
\begin{proof}
	This follows directly from \hyperref[thm:Bessel-ineq]{Bessel's inequality} with the fact that the tail sum is Cauchy, i.e., we have
	\[
		\left\lVert \sum_{k=n}^m x_k\right\rVert ^2 = \sum_{k=n} ^m \left\lVert x_k\right\rVert ^{2} \to 0
	\]
	as \(n, m \to \infty \) from \hyperref[thm:Pythagorean-theorem]{Pythagorean theorem}.
\end{proof}

\autoref{col:lec4} tells us that Fourier series of \(x\) converge. However, it needs not converge to \(x\), although we can still compute the point where it converges to by considering \hyperref[thm:Bessel-ineq]{Bessel's inequality}, and the optimality is guaranteed by \hyperref[thm:orthogonality-principle]{orthogonality principle}.

\begin{theorem}[Optimality of Fourier series]
	Let \(\left\{ x_{k}\right\}_{k} \) be an \hyperref[def:orthonormal-system]{orthonormal system} in a \hyperref[def:Hilbert-space]{Hilbert space} \(\mathcal{H} \). Then the corresponding \hyperref[def:Fourier-series]{Fourier series} \(S_n(x) = \sum_{k=1}^{n} \left\langle  x, x_{k} \right\rangle  x_{k}\) converges, i.e., \(\lim\limits_{n \to \infty} S_{n} (x) = S_{\infty }(x)\) exists for \(x\in \mathcal{H} \). Furthermore, \(S_n = P_{E_n}\) for every \(n\) where \(E_n\) is the space spanned by \(\left\{ x_i \right\} _{i=1}^n\).\footnote{This includes \(n=\infty\), where \(E_\infty \) is the \textbf{closure} of the space spanned by \(\left\{ x_k \right\}_{k\geq 1} \).}
\end{theorem}
\begin{proof}
	We show that the sequence \(S_n(x)\) for \(n = 1, 2, \dots\) is Cauchy. This is because
	\[
		\left\lVert S_n(x) - S_m(x)\right\rVert ^{2} = \sum_{k=m+1}^{n} \left\vert \left\langle x, x_{k}\right\rangle  \right\vert ^{2},
	\]
	and \hyperref[thm:Bessel-ineq]{Bessel's inequality} implies \(\sum_{k=1}^{\infty} \left\vert \left\langle x, x_{k}  \right\rangle  \right\vert ^{2} \leq \left\lVert x\right\rVert ^{2} \). Hence, for any \(\epsilon > 0\), there exists \(m(\epsilon )\) such that
	\[
		\sum_{k=m(\epsilon )+1}^{\infty} \left\vert \left\langle x, x_{k}  \right\rangle  \right\vert ^{2} < \epsilon,
	\]
	which implies \(\left\lVert S_n(x) - S_m(x)\right\rVert ^{2} < \epsilon \) if \(n > m(\epsilon )\), hence \(\left\{ S_{n} (x) \right\}_{n\geq 1}\) is Cauchy, implying
	\[
		\lim_{n \to \infty} S_n(x)= S_\infty (x)\in \mathcal{H} .
	\]
	Also, \(S_\infty = P_{E_\infty }\) where \(E_\infty \) is the closure of the \hyperref[def:linear-vector-space]{linear space} generated by the \(\left\{ x_{k} \right\}_{k \geq 1}\).
\end{proof}

\begin{remark}
	\hyperref[thm:orthogonality-principle]{Orthogonality principle} states that among all convergent series of the form \(S = \sum_{k} a_k x_k \), the approximation error \(\left\lVert x - S\right\rVert \) is minimized by the Fourier series of \(x\) since it's the \hyperref[def:orthogonal-projection]{projection}.
\end{remark}

We finally note that the closedness of \(E_\infty \) makes sense since the self-dual of a set's \hyperref[def:orthogonal-complement]{orthogonal complement} is itself if it's closed in the first place.