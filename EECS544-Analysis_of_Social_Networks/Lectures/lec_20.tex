\lecture{20}{15 Nov. 12:30}{Mixed strategy}
\begin{prev}
	Recall the game \hyperref[matching-pennies]{matching pennies}. Assume that Player \(2\) plays \((\frac{1}{2}, \frac{1}{2})\).
	Now, if player \(1\) plays
	\begin{itemize}
		\item \((1, 0)\): Utility for player \(1\) is \(u_1(H, P^{*}_2) = \frac{1}{2}\cdot 1 + \frac{1}{2}\cdot -1 = 0\).
		\item \((0, 1)\): Utility for player \(1\) is \(u_1(T, P^{*}_2) = \frac{1}{2}\cdot -1 + \frac{1}{2}\cdot 1 = 0\).
	\end{itemize}
	Hence, the utility of player \(1\) is just
	\[
		u_1(P_1, P^{*}_2) = P_1(H)u_1(H, P^{*}_2)+P_1(T)u_1(T, P^{*}_2) = 0.
	\]

	Therefore, any mixed strategy is the best response, so we just use \((\frac{1}{2}, \frac{1}{2})\) for player \(1\), and the same is
	true for player \(2\). In all, we have
	\[
		P_1^{*}\coloneqq \left(\frac{1}{2}, \frac{1}{2}\right), \quad P_2^{*}\coloneqq \left(\frac{1}{2}, \frac{1}{2}\right)
	\]
	as the Nash Equilibrium.

	\begin{problem}
	What if player \(2\) was laying \(\left(\frac{2}{3}, \frac{1}{3}\right)\)?
	\end{problem}
	\begin{answer}
		The best response for player \(1\) is to always play \(H\).\todo{work this out}
	\end{answer}
\end{prev}

\hr

\begin{problem}
The mixed strategies are everywhere in real-life. But how can we understand mixed strategies?
\end{problem}
\begin{answer}
	We see that
	\begin{itemize}
		\item Actions are distributions or beliefs.
		\item In real life, people do randomize-serving in tennis, bluffing in cards game, openings in chess, etc.
		\item Variations in the population and lack of knowledge of how the other person will play.
	\end{itemize}
\end{answer}

\begin{eg}
	Again, we first see an example.
	\begin{itemize}
		\item \label{Football}\textbf{Football}. Let player \(1\) be offense-side, and player \(2\) be defense-side. They both have two options, one is
		      run(or to defense against run), denotes by \(R\),  another is pass(or defense against pass), denotes by \(P\).
		      \begin{table}[H]
			      \centering
			      \setlength{\extrarowheight}{2pt}
			      \begin{tabular}{cc|c|c|}
				                                & \multicolumn{1}{c}{} & \multicolumn{2}{c}{Player $2$}                           \\
				                                & \multicolumn{1}{c}{} & \multicolumn{1}{c}{$R$}        & \multicolumn{1}{c}{$P$} \\\cline{3-4}
				      \multirow{2}*{Player $1$} & $R$                  & $(0, 0)$                       & $(5, -5)$               \\\cline{3-4}
				                                & $P$                  & $(10, -10)$                    & $(0, 0)$                \\\cline{3-4}
			      \end{tabular}
		      \end{table}
		      we then see that there is a Nash Equilibrium such that player \(1\) plays \((\frac{2}{3}, \frac{1}{3})\), while player \(2\) plays
		      \((\frac{1}{3}, \frac{2}{3})\).
	\end{itemize}
\end{eg}

\subsection{Principle of Indifference}
For player \(i\), let \(P_i\in \Delta(\mathcal{S}_{i})\). Now, let \emph{support} of \(P_{i}\) to be the actions with strictly positive probability,
which is just
\[
	\left\{s_{i}\in \mathcal{S}_{i}\colon P_{i}(s_{i})>0\right\}\subseteq \mathcal{S}_{i}.
\]

\begin{eg}
	For example, let \(\left\{a, b, c\right\} = \mathcal{S}_{i}\). Then
	\begin{itemize}
		\item \(P_{i} = (1, 0, 0)\): the support is \(\left\{a\right\}\)
		\item \(P_{i} = (\frac{1}{6}, \frac{5}{6} - \frac{1}{10^6}, \frac{1}{10^6})\): the support is \(\left\{a, b, c\right\}\)
		\item \(P_{i} = (0, \frac{1}{2}, \frac{1}{2})\): the support is \(\left\{b, c\right\}\)
	\end{itemize}
	\begin{note}
		In the second case, we call this a \emph{fully mixed}.
	\end{note}
\end{eg}

\begin{theorem}
	Principle of Indifference. For a Nash Equilibrium \(P^{*}\), for every player \(i\), if
	\[
		\forall s_{i}^j, s_{i}^k\in \text{support}(P_{i}^{*}),
	\]
	we have
	\[
		u_{i}(s_{i}^j, P_{-i}^{*}) = u_{i}(s_{i}^k, P_{-i}^{*}) = u_{i}(P_{i}^*, P_{-i}^{*}).
	\]
\end{theorem}
\begin{intuition}
	In other words, given the strategies of the opponents, player \(i\) is \emph{indifferent} between the strategies in the \(\mathrm{support}(P_{i}^{*}) \)
	because they yield the same payoff.
\end{intuition}
\begin{proof}
	Let \(s_{i}^j, s_{i}^k\in \mathrm{support}(P_i^{*}) \). Then
	\[
		P_i^{*}(s_{i}^j)>0\land P_i^{*}(s_{i}^k)>0.
	\]
	Now, denotes \(\gamma\) as
	\[
		\gamma = \min\left(P_i^{*}(s_{i}^j), P_i^{*}(s_{i}^k)\right)>0,
	\]
	and let \(\epsilon\coloneqq \left[-\gamma, \gamma\right]\). We can then construct a new mixed strategy \(\widetilde{P}_{i}^{\epsilon}\)
	for player \(i\) as follows. For \(s_{i}^j\) and \(s_{i}^k\)
	\[
		\begin{split}
			\widetilde{P}_{i}^{\epsilon}(s_{i}^j) = P_i^{*}(s_{i}^j)- \epsilon\\
			\widetilde{P}_{i}^{\epsilon}(s_{i}^k) = P_i^{*}(s_{i}^k)+\epsilon,
		\end{split}
	\]
	with
	\[
		\underset{s_{i}\in \mathcal{S}_{i}\setminus\left\{s_{i}^j, s_{i}^k\right\}}{\forall} \ \widetilde{P}_{i}^{\epsilon}(s_{i}) = P_i^{*}(s_{i}),
	\]
	which means that the other actions remain the same. Since \(P^{*}\) is a Nash Equilibrium, so we have
	\[
		u_{i}\left(P^{*}_i, P_{i}^{*}\right) = \max_{P_{i}\in \Delta(\mathcal{S}_{i})} u_{i}(P_{i}, P_{-i}^{*}) \geq u_{i}(\widetilde{P}_{i}^{\epsilon}, P_{-i}^{*}).
	\]
	Furthermore, the left-hand side is
	\[
		\begin{split}
			u_{i}\left(P^{*}_i, P_{-i}^{*}\right) = P_{i}^{*}(s_{i}^j)u_{i}(s_{i}^j, P^{*}_{-i}) + P^{*}_{i}(s_{i}^{k})&u_{i}(s_{i}^{k}, P^{*}_{-i})\\
			&+ \sum\limits_{ s_{i}\in \mathcal{S}_{i}\setminus\left\{s_{i}^j, s_{i}^*\right\}} P^{*}_{i}(s_{i})u_{i}(s_{i}, P^{*}_{-i}),
		\end{split}
	\]
	and the right-hand side is
	\[
		\begin{split}
			u_{i}\left(\widetilde{P}^{\epsilon}_i, P_{-i}^{*}\right) = \widetilde{P}_{i}^{\epsilon}(s_{i}^j)u_{i}(s_{i}^j, P^{*}_{-i}) + \widetilde{P}^{\epsilon}_{i}(s_{i}^{k})&u_{i}(s_{i}^{k}, P^{*}_{-i})\\
			&+ \sum\limits_{ s_{i}\in \mathcal{S}_{i}\setminus\left\{s_{i}^j, s_{i}^*\right\}} P^{*}_{i}(s_{i})u_{i}(s_{i}, P^{*}_{-i}).
		\end{split}
	\]

	Then we see that the inequality is
	\[
		P_{i}^{*}(s_{i}^j)u_{i}(s_{i}^j, P_{-i}^{*})+ P_{i}^{*}(s_{i}^k)u_{i}(s_{i}^k, P_{-i}^{*})\geq \widetilde{P}_{i}^{\epsilon}(s_{i}^j)u_{i}(s_{i}^j, P^{*}_{-i})+\widetilde{P}_{i}^{\epsilon}(s_{i}^k)u_{i}(s_{i}^k, P^{*}_{-i})
	\]
	since the summation part is the same. Rearranging, we have
	\[
		\epsilon u_{i}(s_{i}^j, P^{*}_{-i})\geq \epsilon u_{i}(s_{i}^k, P^{*}_{-i}).
	\]
	Since \(\epsilon\in\left[-\gamma, \gamma\right]\), we further have
	\[
		u_{i}(s_{i}^j, P^{*}_{-i}) = u_{i}(s_{i}^k, P^{*}_{-i}) = u.
	\]
	Hence,
	\[
		u_{i}(P^{*}_{i}, P^{*}_{i}) = \sum\limits_{s_{i}\in \mathrm{\text{support}(P^{*}_{i})} }P^{*}_{i}(s_{i})\underbrace{u_{i}(s_{i}, P^{*}_{-i})}_{u} = u.
	\]
	The last equality follows since
	\[
		\sum\limits_{s_{i}\in \mathrm{support}(P^{*}_i) } P_{i}^{*}(s_{i}) = 1.
	\]
\end{proof}

Now, we show a general method to find all Nash Equilibrium in a \(2\) players and \(2\) actions game. Let the payoff matrix be like
\begin{table}[H]
	\centering
	\setlength{\extrarowheight}{2pt}
	\begin{tabular}{cc|c|c|}
		                          & \multicolumn{1}{c}{} & \multicolumn{2}{c}{Player $2$}                           \\
		                          & \multicolumn{1}{c}{} & \multicolumn{1}{c}{$L$}        & \multicolumn{1}{c}{$R$} \\\cline{3-4}
		\multirow{2}*{Player $1$} & $U$                  & $(a_{U, L}, b_{U, L})$         & $(a_{U, R}, b_{U, R})$  \\\cline{3-4}
		                          & $D$                  & $(a_{D, L}, b_{D, L})$         & $(a_{D, R}, b_{D, R})$  \\\cline{3-4}
	\end{tabular}
\end{table}
Let
\begin{itemize}
	\item Player \(1\) plays strategy \((p, 1 - p)\) with \(p\in \left[0, 1\right]\)
	\item Player \(2\) plays strategy \((q, 1 - q)\) with \(q\in \left[0, 1\right]\)
\end{itemize}

We then find all the best-response of each player in a parametric form.
Says player \(1\) with \(p^{*}(q)\), while player \(2\) with \(q^{*}(p)\), where they can be a set. We see that
\[
	p^{*}(q) = \arg\max_{\widetilde{p}\in\left[0, 1\right]}u_1\left((\widetilde{p}, 1 - \widetilde{p}), (q, 1 - q)\right).
\]
Then
\[
	\begin{split}
		&u_1\left((\widetilde{p}, 1 - \widetilde{p}), (q, 1 - q)\right) \\
		= &\widetilde{p}\left(q\cdot a_{U, L} + (1 - q)a_{U, R}\right)+(1 - \widetilde{p})\left(q\cdot a_{D, L}+(1 - q)a_{D, R}\right)\\
		= &\widetilde{p}\left(\left[q\cdot a_{U, L}+(1 - q)a_{U, R}\right] - \left[q\cdot a_{D, L} + (1 - q)a_{D, R}\right]\right)+\left(q\cdot a_{D, L}+(1 - q)a_{D, R}\right)
	\end{split}
\]

Now, denotes \(C\) as
\[
	C\coloneqq \left[q\cdot a_{U, L}+(1 - q)a_{U, R}\right] - \left[q\cdot a_{D, L} + (1 - q)a_{D, R}\right],
\]
there are three cases for \(C\):
\begin{figure}[H]
	\centering
	\incfig{utility-c}
	\label{fig:utility-c}
\end{figure}
We see that
\begin{itemize}
	\item \(C>0\): maximizes in \(\widetilde{p} = 1\)
	\item \(C<0\): maximizes in \(\widetilde{p} = 0\)
	\item \(C=0\): maximizes in \(\widetilde{p} = [0, 1]\)
\end{itemize}

Then we denote
\[
	\arg\max_{\widetilde{p}\in[0, 1]}u_1\left((\widetilde{p}, 1 - \widetilde{p}), (q, 1 - q)\right) \eqqcolon p^{*}\coloneqq
	\begin{dcases}
		1,      & \text{if } C > 0                       \\
		0,      & \text{if } C < 0                       \\
		[0, 1], & \text{if } C = 0(\text{Indifference}).
	\end{dcases}
\]

Use the similar calculations to find \(q^{*}(p)\) using the best response. We conclude that
\[
	(\overline{p}, \overline{q}) \text{ is a Nash Equilibrium} \iff \overline{p}\in p^{*}(\overline{q}) \land \overline{q}\in q^{*}(\overline{p}),
\]
namely they are the best response of each other.

\begin{figure}[H]
	\centering
	\incfig{NE-intersection}
	\label{fig:NE-intersection}
\end{figure}

\begin{itemize}
	\item We come back to the \hyperref[matching-pennies]{matching pennies} games. We see that
	      \[
		      p^{*}(q) = \begin{dcases}
			      1,      & \text{if } q > \frac{1}{2} \\
			      [0, 1], & \text{if } q = \frac{1}{2} \\
			      0,      & \text{if } q < \frac{1}{2}
		      \end{dcases}, \quad q^{*}(p) = \begin{dcases}
			      1,      & \text{if } p > \frac{1}{2}  \\
			      [0, 1], & \text{if } p = \frac{1}{2}  \\
			      0,      & \text{if } p < \frac{1}{2}.
		      \end{dcases}
	      \]
	      After plotting, we see that \((\frac{1}{2}, \frac{1}{2})\) is the only intersection, so it's the only Nash Equilibrium.

	      \begin{figure}[H]
		      \centering
		      \incfig{NE-matching-pennies}
		      \caption{The diagram for matching pennies game}
		      \label{fig:NE-matching-pennies}
	      \end{figure}
	\item We also look at the \hyperref[football]{football} game example. We see that for \(p^{*}(q)\), we have
	      \begin{itemize}
		      \item \(R\): utility is
		            \[
			            q(0)+(1 - q)5 = 5 - 5q.
		            \]
		      \item \(P\): utility is
		            \[
			            q(10)+(1 - q)0 = 10q.
		            \]
	      \end{itemize}
	      Hence, the difference is \(5 - 5q-10q  = 5 - 15q\), hence
	      \[
		      5 - 15q \implies \begin{dcases}
			      \text{Difference }> 0, p^{*}(q) = 1,     & 5>15q \implies q<\frac{1}{3}  \\
			      \text{Difference }< 0, p^{*}(q) = 0,     & 5<15q \implies q>\frac{1}{3}  \\
			      \text{Difference }= 0, p^{*}(q) = [0,1], & 5=15q \implies q=\frac{1}{3}.
		      \end{dcases}
	      \]

	      As for \(q^{*}(p)\), we have
	      \begin{itemize}
		      \item \(R\): utility is
		            \[
			            p(0)+(1 - p)(-10)= -10 + 10p.
		            \]
		      \item \(P\): utility is
		            \[
			            p(-5)+(1 - p)0 = -5q.
		            \]
	      \end{itemize}
	      Hence, the difference is \(-10 + 10p - (-5p) = -10 + 15p\), hence
	      \[
		      -10 +15p\implies \begin{dcases}
			      \text{Difference }> 0, q^{*}(p) = 1,     & 5>15q \implies p>\frac{2}{3}  \\
			      \text{Difference }< 0, q^{*}(p) = 0,     & 5<15q \implies p<\frac{2}{3}  \\
			      \text{Difference }= 0, q^{*}(p) = [0,1], & 5=15q \implies p=\frac{2}{3}.
		      \end{dcases}
	      \]
	      \begin{figure}[H]
		      \centering
		      \incfig{NE-football}
		      \caption{The diagram for football game.}
		      \label{fig:NE-football}
	      \end{figure}
	\item We now look at a new game. Consider the \textbf{Market entering} game. Let the payoff matrix being
	      \begin{table}[H]
		      \centering
		      \setlength{\extrarowheight}{2pt}
		      \begin{tabular}{cc|c|c|}
			                                & \multicolumn{1}{c}{} & \multicolumn{2}{c}{Player $2$}                           \\
			                                & \multicolumn{1}{c}{} & \multicolumn{1}{c}{$E$}        & \multicolumn{1}{c}{$D$} \\\cline{3-4}
			      \multirow{2}*{Player $1$} & $E$                  & $(-1, -1)$                     & $(3, 0)$                \\\cline{3-4}
			                                & $D$                  & $(0, 3)$                       & $(0, 0)$                \\\cline{3-4}
		      \end{tabular}
	      \end{table}
	      We immediately see that \((E, D)\) and \((D, E)\) are pure Nash Equilibrium. And since we always have odd number of Nash Equilibrium,
	      hence there are one more mixed-strategy Nash Equilibrium. By using the principle of indifference, we see that
	      \[
		      \begin{dcases}
			      u_1(E, \overline{q}) & = \overline{q}( - 1)+(1-\overline{q})3 = 3 - 4 \overline{q} \\
			      u_1(D, \overline{q}) & = \overline{q}(0)+(1 - \overline{q})0 = 0,
		      \end{dcases}
	      \]
	      so we have
	      \[
		      u_1(E, \overline{q}) = u_1(D, \overline{q})
	      \]
	      by the principle of indifference. This implies \(\overline{p} = \frac{3}{4}\).
	      \begin{figure}[H]
		      \centering
		      \incfig{NE-market-entering}
		      \caption{The diagram for market entering Game. There are 3 N.E.}
		      \label{fig:NE-market-entering}
	      \end{figure}
\end{itemize}